/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   ft_printf_bonus.c                                  :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: machaq <machaq@1337.student.ma>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2024/11/30 05:59:16 by machaq            #+#    #+#             */
/*   Updated: 2024/11/30 18:13:45 by machaq           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "ft_printf_bonus.h"

int	checker(char spec, va_list args, char flag)
{
	int	i;

	i = 0;
	if (spec == 'c')
		i = ft_putchar(va_arg(args, int));
	else if (spec == 's')
		i = ft_putstr(va_arg(args, char *));
	else if (spec == 'd' || spec == 'i')
		i = ft_printnb(va_arg(args, int), flag);
	else if (spec == 'u')
		i = ft_printunsnb(va_arg(args, unsigned int));
	else if (spec == 'x')
		i = ft_printhex(va_arg(args, unsigned long), "0123456789abcdef", flag);
	else if (spec == 'X')
		i = ft_printhex(va_arg(args, unsigned long), "0123456789ABCDEF", flag);
	else if (spec == 'p')
	{
		i = ft_putstr("0x");
		i += ft_printhex(va_arg(args, unsigned long), "0123456789abcdef", flag);
	}
	else if (spec == '%')
		i = ft_putchar('%');
	return (i);
}

int	ft_printf(const char *s, ...)
{
	va_list	args;
	int		i;
	char	flag;

	va_start(args, s);
	i = 0;
	while (*s)
	{
		if (*s == '%')
		{
			s++;
			flag = 0;
			if (*s == '#' || *s == '+' || *s == ' ')
			{
				flag = *s;
				s++;
			}
			i += checker(*s, args, flag);
		}
		else
			i += ft_putchar(*s);
		s++;
	}
	va_end(args);
	return (i);
}
/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   ft_printf.c                                        :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: machaq <machaq@1337.student.ma>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2024/11/30 16:05:13 by machaq            #+#    #+#             */
/*   Updated: 2024/11/30 18:13:27 by machaq           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "ft_printf.h"

int	checker(char spec, va_list args, char flag)
{
	int	i;

	i = 0;
	if (spec == 'c')
		i = ft_putchar(va_arg(args, int));
	else if (spec == 's')
		i = ft_putstr(va_arg(args, char *));
	else if (spec == 'd' || spec == 'i')
		i = ft_printnb(va_arg(args, int), flag);
	else if (spec == 'u')
		i = ft_printunsnb(va_arg(args, unsigned int));
	else if (spec == 'x')
		i = ft_printhex(va_arg(args, unsigned long), "0123456789abcdef", flag);
	else if (spec == 'X')
		i = ft_printhex(va_arg(args, unsigned long), "0123456789ABCDEF", flag);
	else if (spec == 'p')
	{
		i = ft_putstr("0x");
		i += ft_printhex(va_arg(args, unsigned long), "0123456789abcdef", flag);
	}
	else if (spec == '%')
		i = ft_putchar('%');
	return (i);
}

int	ft_printf(const char *s, ...)
{
	va_list	args;
	int		i;
	char	flag;

	va_start(args, s);
	i = 0;
	while (*s)
	{
		if (*s == '%')
		{
			s++;
			flag = 0;
			if (*s == '#' || *s == '+' || *s == ' ')
			{
				flag = *s;
				s++;
			}
			i += checker(*s, args, flag);
		}
		else
			i += ft_putchar(*s);
		s++;
	}
	va_end(args);
	return (i);
}
/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   ft_printhex_bonus.c                                :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: machaq <machaq@1337.student.ma>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2024/11/30 06:50:15 by machaq            #+#    #+#             */
/*   Updated: 2024/11/30 13:37:29 by machaq           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "ft_printf_bonus.h"

int	ft_printhex(unsigned long address, const char *base, char flag)
{
	int	len;

	len = 0;
	if (address == 0)
	{
		ft_putchar('0');
		return (1);
	}
	if (flag == '#' && address != 0)
	{
		ft_putchar('0');
		if (base[10] == 'a')
			ft_putchar('x');
		else
			ft_putchar('X');
		len += 2;
	}
	if (address >= 16)
		len += ft_printhex(address / 16, base, 0);
	ft_putchar(base[address % 16]);
	return (len + 1);
}
/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   ft_printhex.c                                      :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: machaq <machaq@1337.student.ma>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2024/11/30 16:06:10 by machaq            #+#    #+#             */
/*   Updated: 2024/11/30 16:06:24 by machaq           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "ft_printf.h"

int	ft_printhex(unsigned long address, const char *base, char flag)
{
	int	len;

	len = 0;
	if (address == 0)
	{
		ft_putchar('0');
		return (1);
	}
	if (flag == '#' && address != 0)
	{
		ft_putchar('0');
		if (base[10] == 'a')
			ft_putchar('x');
		else
			ft_putchar('X');
		len += 2;
	}
	if (address >= 16)
		len += ft_printhex(address / 16, base, 0);
	ft_putchar(base[address % 16]);
	return (len + 1);
}
/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   ft_printnb_bonus.c                                 :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: machaq <machaq@1337.student.ma>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2024/11/30 06:36:09 by machaq            #+#    #+#             */
/*   Updated: 2024/11/30 18:07:46 by machaq           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "ft_printf_bonus.h"

int	ft_printnb(int nb, char flag)
{
	int	len;

	len = 0;
	if (nb == -2147483648)
		return (write(1, "-2147483648", 11));
	if (nb < 0)
	{
		ft_putchar('-');
		nb = -nb;
	}
	else if (flag == '+')
	{
		ft_putchar('+');
		len++;
	}
	else if (flag == ' ')
	{
		ft_putchar(' ');
		len++;
	}
	if (nb >= 10)
		len += ft_printnb(nb / 10, 0);
	ft_putchar((nb % 10) + '0');
	return (len + 1);
}
/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   ft_printnb.c                                       :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: machaq <machaq@1337.student.ma>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2024/11/30 16:06:39 by machaq            #+#    #+#             */
/*   Updated: 2024/11/30 18:07:00 by machaq           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "ft_printf.h"

int	ft_printnb(int nb, char flag)
{
	int	len;

	len = 0;
	if (nb == -2147483648)
		return (write(1, "-2147483648", 11));
	if (nb < 0)
	{
		ft_putchar('-');
		nb = -nb;
	}
	else if (flag == '+')
	{
		ft_putchar('+');
		len++;
	}
	else if (flag == ' ')
	{
		ft_putchar(' ');
		len++;
	}
	if (nb >= 10)
		len += ft_printnb(nb / 10, 0);
	ft_putchar((nb % 10) + '0');
	return (len + 1);
}
/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   ft_printunsnb_bonus.c                              :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: machaq <machaq@1337.student.ma>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2024/11/30 06:43:42 by machaq            #+#    #+#             */
/*   Updated: 2024/11/30 13:37:36 by machaq           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "ft_printf_bonus.h"

int	ft_printunsnb(unsigned int i)
{
	int	len;

	len = 0;
	if (i == 0)
	{
		ft_putchar('0');
		return (1);
	}
	if (i >= 10)
		len += ft_printunsnb(i / 10);
	ft_putchar((i % 10) + '0');
	return (len + 1);
}
/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   ft_printunsnb.c                                    :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: machaq <machaq@1337.student.ma>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2024/11/30 16:07:33 by machaq            #+#    #+#             */
/*   Updated: 2024/11/30 16:07:47 by machaq           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "ft_printf.h"

int	ft_printunsnb(unsigned int i)
{
	int	len;

	len = 0;
	if (i == 0)
	{
		ft_putchar('0');
		return (1);
	}
	if (i >= 10)
		len += ft_printunsnb(i / 10);
	ft_putchar((i % 10) + '0');
	return (len + 1);
}
/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   ft_putchar_bonus.c                                 :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: machaq <machaq@1337.student.ma>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2024/11/30 06:21:02 by machaq            #+#    #+#             */
/*   Updated: 2024/11/30 17:30:28 by machaq           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "ft_printf_bonus.h"

int	ft_putchar(char c)
{
	write(1, &c, 1);
	return (1);
}
/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   ft_putchar.c                                       :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: machaq <machaq@1337.student.ma>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2024/11/30 16:08:05 by machaq            #+#    #+#             */
/*   Updated: 2024/11/30 17:29:05 by machaq           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "ft_printf.h"

int	ft_putchar(char c)
{
	write(1, &c, 1);
	return (1);
}
/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   ft_putstr_bonus.c                                  :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: machaq <machaq@1337.student.ma>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2024/11/30 06:32:24 by machaq            #+#    #+#             */
/*   Updated: 2024/11/30 17:30:56 by machaq           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "ft_printf_bonus.h"

int	ft_putstr(const char *s)
{
	int	i;

	i = 0;
	if (s == NULL)
	{
		ft_putstr("(null)");
		return (6);
	}
	while (*s)
	{
		ft_putchar(*s++);
		i++;
	}
	return (i);
}
/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   ft_putstr.c                                        :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: machaq <machaq@1337.student.ma>            +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2024/11/30 16:08:32 by machaq            #+#    #+#             */
/*   Updated: 2024/11/30 17:28:40 by machaq           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "ft_printf.h"

int	ft_putstr(const char *s)
{
	int	i;

	i = 0;
	if (s == NULL)
	{
		ft_putstr("(null)");
		return (6);
	}
	while (*s)
	{
		ft_putchar(*s++);
		i++;
	}
	return (i);
}
CC			= gcc
CFLAGS		= -Wall -Wextra -Werror

NAME		= libftprintf.a

MANDATORY_SRCS = ft_printf.c \
				  ft_printhex.c \
				  ft_printnb.c \
				  ft_printunsnb.c \
				  ft_putchar.c \
				  ft_putstr.c

BONUS_SRCS = ft_printf_bonus.c \
			  ft_printhex_bonus.c \
			  ft_printnb_bonus.c \
			  ft_printunsnb_bonus.c \
			  ft_putchar_bonus.c \
			  ft_putstr_bonus.c

MANDATORY_OBJS = ${MANDATORY_SRCS:.c=.o}
BONUS_OBJS     = ${BONUS_SRCS:.c=.o}

all: ${NAME}

${NAME}: ${MANDATORY_OBJS}
	ar rcs ${NAME} ${MANDATORY_OBJS}

bonus: ${MANDATORY_OBJS} ${BONUS_OBJS}
	ar rcs ${NAME} ${MANDATORY_OBJS} ${BONUS_OBJS}

%.o: %.c ft_printf.h
	${CC} ${CFLAGS} -c $< -o $@

clean:
	rm -f ${MANDATORY_OBJS} ${BONUS_OBJS}

fclean: clean
	rm -f ${NAME}


re: fclean all

.PHONY: all bonus clean fclean re
